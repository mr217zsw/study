import{_ as H,n as g,p as v,q as J,x as P,r as n,g as U,o as k,f as $,e,w as t,k as m,F,h as Q,d as R,z as X,E as Z,A as B}from"./index-BJRvKRCp.js";const ee={class:"user-header"},le={class:"table-block"},te={__name:"User",setup(ae){const D=g([{prop:"name",label:"姓名"},{prop:"age",label:"年龄"},{prop:"sex",label:"性别"},{prop:"birth",label:"出生日期"},{prop:"addr",label:"地址"}]),C=v([]),{proxy:u}=J(),_=async()=>{let r=await u.$api.getUserData(c);C.value=r.list,c.total=r.count},f=g({keyWord:""}),c=g({keyword:"",total:0,page:1}),q=()=>{c.keyword=f.keyWord,_()},S=r=>{c.page=r,_()},E=r=>{Z.confirm("你确定要删除吗?","Confirm",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"Confirm"}).then(async()=>{await u.$api.deleteUser({id:r.id}),_()}).catch(()=>{B({showClose:!0,type:"info",message:"删除取消"})})},b=v("add"),i=v(!1),o=g({}),M=g({name:[{required:!0,message:"姓名不能为空",trigger:"blur"},{min:2,max:10,message:"姓名长度应为 2 到 10 个字符",trigger:"blur"}],age:[{required:!0,message:"年龄不能为空",trigger:"blur"},{type:"number",message:"年龄必须是数字",trigger:"blur"},{validator:(r,l,s)=>{l<0||l>150?s(new Error("年龄范围应为 0 到 150")):s()},trigger:"blur"}],sex:[{required:!0,message:"性别不能为空",trigger:"change"}],birth:[{required:!0,message:"出生日期不能为空",trigger:"change"},{type:"date",message:"出生日期格式不正确",trigger:"change"}],addr:[{required:!0,message:"地址不能为空",trigger:"blur"},{min:2,max:100,message:"地址长度应在 2 到 100 个字符之间",trigger:"blur"}]}),T=()=>{i.value=!1,u.$refs.userForm.resetFields()},W=()=>{i.value=!1,u.$refs.userForm.resetFields()},z=()=>{i.value=!0,b.value="add"},I=r=>{b.value="update",i.value=!0,X(()=>{Object.assign(o,r)})};function N(r){const l=new Date(r),s=l.getFullYear(),p=String(l.getMonth()+1).padStart(2,"0"),d=String(l.getDate()).padStart(2,"0");return`${s}-${p}-${d}`}const A=()=>{u.$refs.userForm.validate(async r=>{if(r)try{N(o.birth),b.value==="add"?await u.$api.addUser(o):await u.$api.updateUser(o),i.value=!1,u.$refs.userForm.resetFields(),_()}catch{B({showClose:!0,message:"请输入正确的内容",type:"error"})}})};return P(()=>{_()}),(r,l)=>{const s=n("el-button"),p=n("el-input"),d=n("el-form-item"),w=n("el-form"),x=n("el-table-column"),L=n("el-table"),O=n("el-pagination"),y=n("el-col"),h=n("el-option"),j=n("el-select"),K=n("el-date-picker"),V=n("el-row"),Y=n("el-dialog");return k(),U(F,null,[$("div",ee,[e(s,{type:"primary",onClick:z},{default:t(()=>l[7]||(l[7]=[m(" 新增 ",-1)])),_:1,__:[7]}),e(w,{inline:!0,model:f},{default:t(()=>[e(d,{label:"请输入"},{default:t(()=>[e(p,{placeholder:"请输入用户名",modelValue:f.keyWord,"onUpdate:modelValue":l[0]||(l[0]=a=>f.keyWord=a)},null,8,["modelValue"])]),_:1}),e(d,null,{default:t(()=>[e(s,{type:"primary",onClick:q},{default:t(()=>l[8]||(l[8]=[m(" 搜索 ",-1)])),_:1,__:[8]})]),_:1})]),_:1},8,["model"])]),$("div",le,[e(L,{data:C.value,style:{width:"100%"}},{default:t(()=>[(k(!0),U(F,null,Q(D,a=>(k(),R(x,{key:a.prop,prop:a.prop,label:a.label},null,8,["prop","label"]))),128)),e(x,{fixed:"right",label:"操作","min-width":"120"},{default:t(a=>[e(s,{type:"primary",size:"small",onClick:G=>I(a.row)},{default:t(()=>l[9]||(l[9]=[m("编辑",-1)])),_:2,__:[9]},1032,["onClick"]),e(s,{type:"danger",size:"small",onClick:G=>E(a.row)},{default:t(()=>l[10]||(l[10]=[m("删除",-1)])),_:2,__:[10]},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(O,{class:"pager",background:"",layout:"prev, pager, next",total:c.total,onCurrentChange:S},null,8,["total"])]),e(Y,{modelValue:i.value,"onUpdate:modelValue":l[6]||(l[6]=a=>i.value=a),title:b.value==="add"?"新增用户":"编辑用户",width:"35%","before-close":T},{default:t(()=>[e(w,{inline:!0,model:o,rules:M,ref:"userForm"},{default:t(()=>[e(V,null,{default:t(()=>[e(y,{span:12},{default:t(()=>[e(d,{label:"姓名",prop:"name"},{default:t(()=>[e(p,{modelValue:o.name,"onUpdate:modelValue":l[1]||(l[1]=a=>o.name=a),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1})]),_:1}),e(y,{span:12},{default:t(()=>[e(d,{label:"年龄",prop:"age"},{default:t(()=>[e(p,{modelValue:o.age,"onUpdate:modelValue":l[2]||(l[2]=a=>o.age=a),modelModifiers:{number:!0},placeholder:"请输入年龄"},null,8,["modelValue"])]),_:1})]),_:1}),e(y,{span:12},{default:t(()=>[e(d,{class:"select-clearn",label:"性别",prop:"sex"},{default:t(()=>[e(j,{modelValue:o.sex,"onUpdate:modelValue":l[3]||(l[3]=a=>o.sex=a),placeholder:"请选择",clearable:""},{default:t(()=>[e(h,{label:"男",value:"男"}),e(h,{label:"女",value:"女"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(y,{span:12},{default:t(()=>[e(d,{label:"出生日期",prop:"birth"},{default:t(()=>[e(K,{modelValue:o.birth,"onUpdate:modelValue":l[4]||(l[4]=a=>o.birth=a),type:"date",placeholder:"请输入",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(V,null,{default:t(()=>[e(d,{label:"地址",prop:"addr"},{default:t(()=>[e(p,{modelValue:o.addr,"onUpdate:modelValue":l[5]||(l[5]=a=>o.addr=a),placeholder:"请输入地址"},null,8,["modelValue"])]),_:1})]),_:1}),e(V,null,{default:t(()=>[e(d,{style:{"margin-inline":"center"}},{default:t(()=>[e(s,{type:"primary",onClick:W},{default:t(()=>l[11]||(l[11]=[m("取消",-1)])),_:1,__:[11]}),e(s,{type:"primary",onClick:A},{default:t(()=>l[12]||(l[12]=[m("确定",-1)])),_:1,__:[12]})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])],64)}}},re=H(te,[["__scopeId","data-v-e59a42ba"]]);export{re as default};
